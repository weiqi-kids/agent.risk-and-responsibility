---
title: "Four Seconds to Botnet - Analyzing a Self Propagating SSH Worm with Cryptographically Signed C2"
source_url: https://isc.sans.edu/diary/rss/32708
date: 2026-02-12
category: malware
confidence: 高
---

## L1 — Rule Signal
- **rule_type**: guidance
- **issuing_body**: SANS Internet Storm Center
- **document_id**: 32708
- **status**: final
- **cve_references**: N/A
- **threat_actor**: Unknown (使用已被破壞的 Raspbian 設備進行攻擊)
- **attack_technique**: T1110.001 (Brute Force: Password Guessing), T1021.004 (Remote Services: SSH), T1059.004 (Command and Scripting Interpreter: Unix Shell), T1018 (Remote System Discovery), T1046 (Network Service Discovery)

## L2 — Responsibility Structure
- **affected_roles**: security analysts, SOC teams, network administrators, IoT device administrators, system administrators
- **shift_type**: expanded
- **shift_summary**: 因自我傳播型 SSH 蠕蟲能在 4 秒內完成入侵，管理者必須立即檢視所有使用預設認證的設備並實施強化措施

## L3 — Risk Domains
- 橫向移動風險：蠕蟲可快速掃描並感染其他 SSH 設備
- 物聯網設備安全：樹莓派等 IoT 設備成為攻擊跳板
- 認證管理：使用弱密碼和預設認證的系統面臨立即風險
- 網絡隔離不足：缺乏適當隔離使蠕蟲可快速擴散
- 持久化威脅：惡意軟體建立後門並清除競爭者

## L4 — Obligation & Evidence
- **new_obligations**:
  - 禁用所有設備的 SSH 密碼認證，僅使用密鑰認證
  - 移除樹莓派和其他 IoT 設備的預設用戶帳號
  - 部署 fail2ban 或類似工具防止 SSH 暴力破解
  - 為 IoT 設備實施網絡隔離
  - 監控異常 SSH 連接模式，特別是來自 Raspbian 客戶端的連接
  - 定期檢查 hosts 檔案是否被篡改
  - 監控對已知 C2 伺服器的 IRC 連接嘗試（6 個 IRC 網絡的 #biret 頻道）
- **evidence_requirements**:
  - SSH 登入日誌顯示已禁用密碼認證
  - 設備配置顯示已移除預設用戶
  - fail2ban 或類似工具的部署與運作記錄
  - 網絡隔離配置文件與 VLAN 設定
  - 異常 SSH 流量偵測與警報記錄
  - IRC 流量監控報告
- **enforcement_signal**: recommended

## Notes

此攻擊展示了驚人的速度與效率：
- **08:24:13** - 攻擊者連接
- **08:24:14** - 暴力破解成功 (pi / raspberryraspberry993311)
- **08:24:15** - 4.7KB 惡意腳本透過 SCP 上傳
- **08:24:16** - 惡意軟體執行並建立持久性
- **08:24:17** - C2 檢查並開始掃描

**C2 架構特徵**：蠕蟲使用嵌入式 RSA 密鑰驗證來自 C2 操作員的命令，連接至 6 個 IRC 網絡上的 #biret 頻道。

**橫向移動策略**：部署 zmap 和 sshpass 工具，掃描 100,000 個隨機 IP 尋找開放的 SSH 端口，嘗試兩組認證：
1. pi / raspberry
2. pi / raspberryraspberry993311

**持久化機制**：修改系統檔案建立後門，清除競爭者惡意軟體，並篡改 hosts 檔案將已知 C2 伺服器指向環回位址。

**攻擊源**：來自德國 ISP (83.135.10.12)，使用 "Raspbian" SSH 客戶端，表明該攻擊源自已被破壞的樹莓派設備。

此案例突顯了預設認證和安全強化不足對小型 Linux 裝置的威脅，特別是在物聯網環境中。
