---
title: "WSL in the Malware Ecosystem"
source_url: https://isc.sans.edu/diary/rss/32704
date: 2026-02-11
category: malware
confidence: 高
---

## L1 — Rule Signal
- **rule_type**: guidance
- **issuing_body**: SANS Internet Storm Center
- **document_id**: 32704
- **status**: final
- **cve_references**: N/A
- **threat_actor**: Cryxos 木馬程式開發者
- **attack_technique**: T1082 (System Information Discovery), T1083 (File and Directory Discovery), T1552.001 (Unsecured Credentials: Credentials In Files), T1005 (Data from Local System), T1106 (Native API)

## L2 — Responsibility Structure
- **affected_roles**: security analysts, Windows system administrators, SOC teams, endpoint protection administrators, threat hunters
- **shift_type**: new
- **shift_summary**: 惡意軟體開發者已開始利用 WSL 作為攻擊媒介，管理者需建立新的監控機制以偵測跨平台惡意活動

## L3 — Risk Domains
- 跨平台攻擊：惡意軟體可同時利用 Windows 和 Linux 環境
- 認證資訊竊取：透過 WSL 存取 Windows 使用者目錄和檔案
- 偵測規避：WSL 環境可能繞過傳統 Windows 安全工具
- 攻擊面擴大："/mnt" 目錄提供對所有主機磁碟機的存取
- 環境指紋識別：惡意軟體可偵測 WSL 環境並調整行為

## L4 — Obligation & Evidence
- **new_obligations**:
  - 監控 WSL_DISTRO_NAME 環境變數的異常存取
  - 檢查 "/proc/version" 檔案的可疑讀取行為
  - 監控透過 cmd.exe 執行的跨平台命令
  - 追蹤對 "/mnt/c/Users" 目錄的異常掃描活動
  - 監控透過 "\\wsl$" 網路共享的檔案存取
  - 實施 WSL 環境的端點偵測與回應 (EDR) 覆蓋
  - 建立 WSL 環境的基線行為以識別異常
  - 限制不必要的 WSL 啟用與使用
- **evidence_requirements**:
  - WSL 環境的異常活動偵測日誌
  - 跨平台檔案存取模式的監控記錄
  - EDR 系統對 WSL 相關威脅的偵測報告
  - WSL 使用政策與批准記錄
  - 可疑 JavaScript 檔案的檢測與分析報告
- **enforcement_signal**: recommended

## Notes

**WSL 技術背景**：
Windows Subsystem for Linux (WSL) 是 Microsoft Windows 生態系統中的功能，允許使用者在 Windows 內直接執行真正的 Linux 環境，無需傳統虛擬機或雙重開機設定。WSL2 執行輕量級虛擬化 Linux 核心，於 2016 年作為 Windows 10 的一部分推出。

**跨平台存取機制**：
攻擊者可透過 "\\wsl$" 網路共享名稱存取 WSL 根檔案系統，將 Linux 工具複製到此目錄，使其在 WSL 環境中可用，甚至可從 Windows 直接執行。

**實際惡意軟體案例 - Cryxos 木馬程式**：

樣本名稱：`ottercookie-socketScript-module-3.js`
SHA256：`f44c2169250f86c8b42ec74616eacb08310ccc81ca9612eb68d23dc8715d7370`

**環境檢測技術**：
- 檢查 `WSL_DISTRO_NAME` 環境變數
- 掃描 "/proc/version" 檔案中的 "microsoft" 或 "wsl" 字串

**認證資訊擷取**：
- 透過 cmd.exe 執行命令取得 Windows 使用者名稱
- 掃描 "/mnt/c/Users" 目錄存取主機使用者檔案

**擴展搜尋範圍**：
若偵測到 WSL 環境，惡意軟體將 "/mnt" 目錄納入掃描清單，以存取所有主機磁碟機（/mnt/c, /mnt/d 等）。

**威脅情報**：
Cryxos 木馬程式是一款 JavaScript 編寫的資訊竊取工具，此樣本展示了惡意軟體生態系統已開始整合 WSL 偵測與利用能力，以擴大資料竊取範圍。

雖然文章未明確提出完整的防護建議，但隱含應建立對 WSL 環境中異常活動和跨平台檔案存取模式的監控機制。
