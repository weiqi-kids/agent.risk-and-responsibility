---
title: "Malicious Script Delivering More Maliciousness"
source_url: https://isc.sans.edu/diary/rss/32682
date: 2026-02-05
category: malware
confidence: 高
---

## L1 — Rule Signal
- **rule_type**: guidance
- **issuing_body**: SANS Internet Storm Center
- **document_id**: N/A
- **status**: final
- **attack_technique**: MITRE ATT&CK - T1053.005 (Scheduled Task/Job), T1140 (Deobfuscate/Decode Files or Information), T1071.001 (Web Protocols - Application Layer Protocol)

## L2 — Responsibility Structure
- **affected_roles**: SOC analysts, Malware analysts, Incident response teams, Email security administrators, Endpoint security teams
- **shift_type**: new
- **shift_summary**: 發現新型多階段惡意軟體鏈，結合批次腳本混淆、圖像隱寫術、十六進位編碼與 .NET 編譯，最終投放 XWorm 遠端存取木馬

## L3 — Risk Domains
- Malware analysis and reverse engineering
- Email attachment security
- Multi-stage attack detection
- Endpoint detection and response
- Persistence mechanism monitoring

## L4 — Obligation & Evidence
- **new_obligations**:
  - 監控 PowerShell 執行包含 Base64 解碼與混淆字元的活動
  - 偵測從圖像檔案中提取並執行 shellcode 的行為
  - 追蹤名為 "Chromiumx2" 的排程任務或類似持久化機制
  - 監控與 Telegram Bot API 的異常連線活動
  - 檢查 .NET 程式載入並執行 XWorm 相關組件
- **evidence_requirements**:
  - 保留多階段攻擊鏈的所有中間產物（批次腳本、圖像檔案、解碼後的 shellcode、.NET payload）
  - 記錄 C2 通訊至 Telegram 的系統資訊外洩（CPU、GPU、RAM、OS）
  - 保存 SHA256 雜湊值：d99318c9b254b4fa5bf6f1dd15996dd50be0676dd84e822503fd273316eb9ba7
- **enforcement_signal**: recommended

## Notes
攻擊鏈技術細節：

**階段 1 - 惡意批次腳本**：修改自 Chrome 漏洞利用工具的 .bat 檔，包含 Base64 編碼資料並透過 PowerShell 執行，混入垃圾字元混淆。

**階段 2 - 基於圖像的 payload 投放**：從 `hxxps://uniworldrivercruises-co[.]uk/optimized_MSI.png` 擷取內容，該檔案表面為圖像但內嵌 shellcode，使用 `BaseStart-` 和 `-BaseEnd` 標記分隔。

**階段 3 - 解碼挑戰**：提取的 shellcode 包含反轉的 Base64 編碼資料與非十六進位字元，需使用 Python 腳本進行 regex 清理與十六進位反轉。

**階段 4 - .NET Payload**：解碼後為 .NET 程式，實作持久化機制（每分鐘執行的 Chromiumx2 排程任務）、C2 通訊（Telegram Bot API）與 XWorm V7.0/V7.1 系統資訊竊取功能。

此攻擊展示了複雜的多層混淆技術，結合批次腳本、圖像隱寫術、十六進位編碼與 .NET 編譯，以在投放偵察惡意軟體的同時規避偵測。
