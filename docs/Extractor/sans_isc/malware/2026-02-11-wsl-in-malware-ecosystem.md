---
title: "WSL in the Malware Ecosystem"
source_url: https://isc.sans.edu/diary/rss/32704
date: 2026-02-11
category: malware
confidence: 高
---

## L1 — Rule Signal
- **rule_type**: guidance
- **issuing_body**: SANS Internet Storm Center
- **document_id**: 無
- **status**: final
- **attack_technique**: T1078 (Valid Accounts), T1552.001 (Unsecured Credentials: Credentials In Files)

## L2 — Responsibility Structure
- **affected_roles**: security engineers, endpoint detection teams, IT administrators, incident responders
- **shift_type**: new
- **shift_summary**: 威脅行為者利用 WSL 作為 LOLBIN（Living-Off-the-Land Binary），在 Windows 環境中執行 Linux 工具竊取憑證，要求防禦方監控跨邊界執行行為

## L3 — Risk Domains
- **Cybersecurity Risk**: 憑證竊取、跨平台攻擊面擴大、傳統 Windows 安全工具偵測盲點
- **Operational Risk**: WSL rootfs 中的惡意二進位檔案可能被忽略

## L4 — Obligation & Evidence
- **new_obligations**:
  - 監控 `\\wsl$` 網路共享的異常檔案寫入（尤其可執行檔、腳本）
  - 稽核企業環境中啟用 WSL 的系統；透過群組原則限制非必要的 WSL 安裝
  - 檢查由 `wsl.exe` 或 Linux 二進位檔案啟動的 `cmd.exe` 程序（跨邊界執行）
  - 標記環境變數查詢（如 `WSL_DISTRO_NAME`）作為潛在偵測指標
  - 審查從 WSL 內部列舉 `/mnt/c/Users` 目錄的行為（憑證竊取前兆）
- **evidence_requirements**:
  - `\\wsl$` 存取日誌
  - wsl.exe 程序啟動紀錄與指令行參數
  - 環境變數查詢與 `/proc/version` 讀取事件
  - `/mnt/c/Users` 目錄列舉紀錄
- **enforcement_signal**: recommended

## Notes
**WSL (Windows Subsystem for Linux)** 是 Microsoft 自 2016 年起（Windows 10）引入的原生功能，允許在 Windows 上直接執行真實的 Linux 環境，無需傳統虛擬機或雙開機。WSL2 執行輕量級虛擬化 Linux kernel，提升相容性與效能。

**威脅行為者利用方式**:
- 透過 `\\wsl$` 網路共享將 Linux 工具投放至 WSL rootfs，再從 Windows 執行
- 偵測 WSL 環境：檢查 `WSL_DISTRO_NAME` 環境變數、讀取 `/proc/version` 尋找 "microsoft" 或 "wsl" 字串
- 列舉 Windows 使用者：執行 `cmd.exe /c echo %USERNAME%` 或掃描 `/mnt/c/Users/` 目錄
- 存取主機磁碟機：透過 `/mnt` 掛載點（如 `/mnt/c`）存取 Windows 磁碟機，竊取瀏覽器憑證

**惡意軟體樣本**:
- **檔名**: `ottercookie-socketScript-module-3.js`
- **SHA256**: `f44c2169250f86c8b42ec74616eacb08310ccc81ca9612eb68d23dc8715d7370`
- **分類**: Cryxos Trojan（資訊竊取能力）
- **語言**: JavaScript
- **關鍵函式**: `is_wsl()`, `get_wu()`, `getWindowsBrowserPaths()`

**安全影響**:
- WSL 創造 **雙重攻擊面**：惡意軟體可在 Linux 環境運作，同時存取 Windows 資源
- 傳統 Windows 安全工具可能忽略 WSL rootfs 中的 Linux 原生惡意二進位檔案
- Linux/Windows 環境邊界模糊，增加鑑識分析複雜度

作者 Xavier Mertens (SANS ISC Senior Handler) 於 2026 年 2 月 11 日發布。
