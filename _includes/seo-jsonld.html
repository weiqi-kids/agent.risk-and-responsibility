{% comment %}
SEO JSON-LD 結構化資料產生器
產生 7 種必填 Schema：WebPage、Article、Person、Organization、BreadcrumbList、FAQPage、ImageObject
{% endcomment %}

{% assign page_url = page.url | absolute_url %}
{% assign site_url = site.url %}
{% assign seo = page.seo %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebPage",
      "@id": "{{ page_url }}#webpage",
      "url": "{{ page_url }}",
      "name": "{% if seo.title %}{{ seo.title }}{% else %}{{ page.title }}{% endif %}",
      "description": "{% if seo.description %}{{ seo.description }}{% else %}{{ site.description }}{% endif %}",
      "inLanguage": "{{ site.data.seo-defaults.language | default: 'zh-TW' }}",
      "isPartOf": { "@id": "{{ site_url }}#website" },
      "primaryImageOfPage": { "@id": "{{ page_url }}#primaryimage" },
      "datePublished": "{% if seo.date_published %}{{ seo.date_published }}{% else %}{{ page.date | date: '%Y-%m-%d' }}{% endif %}",
      "dateModified": "{% if seo.date_modified %}{{ seo.date_modified }}{% else %}{{ page.date | date: '%Y-%m-%d' }}{% endif %}",
      "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": {{ site.data.seo-defaults.speakable_selectors | jsonify }}
      }
    },
    {
      "@type": "Article",
      "@id": "{{ page_url }}#article",
      "mainEntityOfPage": {
        "@id": "{{ page_url }}#webpage"{% if seo.related_articles %},
        "significantLink": {{ seo.related_articles | jsonify }}{% endif %}
      },
      "headline": "{% if seo.title %}{{ seo.title }}{% else %}{{ page.title }}{% endif %}",
      "description": "{% if seo.description %}{{ seo.description }}{% else %}{{ site.description }}{% endif %}",
      "image": { "@id": "{{ page_url }}#primaryimage" },
      "author": { "@id": "{{ site.data.seo-site.author.url }}#person" },
      "publisher": { "@id": "{{ site_url }}#organization" },
      "datePublished": "{% if seo.date_published %}{{ seo.date_published }}{% else %}{{ page.date | date: '%Y-%m-%d' }}{% endif %}",
      "dateModified": "{% if seo.date_modified %}{{ seo.date_modified }}{% else %}{{ page.date | date: '%Y-%m-%d' }}{% endif %}",
      "articleSection": "{% if seo.article_section %}{{ seo.article_section }}{% else %}{{ page.parent }}{% endif %}",
      "keywords": "{% if seo.keywords %}{{ seo.keywords | join: ', ' }}{% else %}{{ site.data.seo-defaults.default_keywords | join: ', ' }}{% endif %}",
      "inLanguage": "{{ site.data.seo-defaults.language | default: 'zh-TW' }}",
      "isAccessibleForFree": true,
      "isPartOf": {
        "@type": "WebSite",
        "@id": "{{ site_url }}#website",
        "name": "{{ site.title }}",
        "url": "{{ site_url }}",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "{{ site_url }}/search?q={search_term}",
          "query-input": "required name=search_term"
        }
      }
    },
    {{ site.data.seo-site.person | jsonify }},
    {{ site.data.seo-site.organization | jsonify }},
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "首頁",
          "item": "{{ site_url }}"
        }{% if page.parent %},
        {
          "@type": "ListItem",
          "position": 2,
          "name": "{{ page.parent }}",
          "item": "{{ site_url }}/docs/Narrator/{{ page.parent | slugify }}"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page.title }}",
          "item": "{{ page_url }}"
        }{% endif %}
      ]
    }{% if seo.faq %},
    {
      "@type": "FAQPage",
      "mainEntity": [{% for qa in seo.faq %}
        {
          "@type": "Question",
          "name": "{{ qa.question }}",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "{{ qa.answer }}"
          }
        }{% unless forloop.last %},{% endunless %}{% endfor %}
      ]
    }{% endif %},
    {
      "@type": "ImageObject",
      "@id": "{{ page_url }}#primaryimage",
      "url": "{% if seo.image %}{{ seo.image }}{% else %}{{ site.data.seo-defaults.og_image }}{% endif %}",
      "width": {{ site.data.seo-defaults.og_image_width | default: 1200 }},
      "height": {{ site.data.seo-defaults.og_image_height | default: 630 }},
      "caption": "{% if seo.image_alt %}{{ seo.image_alt }}{% else %}{{ page.title }}{% endif %}",
      "representativeOfPage": true,
      "license": "{{ site.data.seo-defaults.image_license_url }}",
      "creditText": "{{ site.data.seo-defaults.image_credit }}"
    }
  ]
}
</script>
