{% comment %}
Just the Docs 主題的 head 擴充點
用於注入 SEO JSON-LD、Meta 標籤、Mermaid 圖表支援

TBT 優化說明：
- 主要優化已移至 _includes/head.html（加 defer 到 JS）
- Mermaid 使用 type="module" 非阻塞載入
{% endcomment %}

{% if page.layout == 'report' or page.seo %}
  {% include seo-jsonld.html %}
  {% include seo-meta.html %}
{% endif %}

{% comment %} Mermaid.js 圖表支援（S9 視覺化）- 僅在有圖表時載入 {% endcomment %}
<script>
  // 延遲載入 Mermaid：僅在頁面有 .mermaid 或 .language-mermaid 時才載入
  (function() {
    function loadMermaid() {
      if (document.querySelector('.mermaid, .language-mermaid, pre code.language-mermaid')) {
        import('https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs')
          .then(m => m.default.initialize({ startOnLoad: true, theme: 'neutral' }));
      }
    }
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadMermaid);
    } else {
      loadMermaid();
    }
  })();
</script>
